# T2Rankingæ•°æ®é›†å¯¼å…¥é“¾è·¯ - å®æ–½æ€»ç»“

## å®æ–½æ—¶é—´
2025-11-07

## å®æ–½ç›®æ ‡
å®ŒæˆT2Rankingæ•°æ®é›†å¯¼å…¥åˆ°çŸ¥è¯†åº“çš„æ ¸å¿ƒæ•°æ®æµé“¾è·¯ï¼Œä½¿æ–‡æ¡£å’Œæµ‹è¯•ç”¨ä¾‹èƒ½å¤Ÿå®Œæ•´å¯¼å…¥ç³»ç»Ÿã€‚

---

## å·²å®ŒæˆåŠŸèƒ½

### 1. åç«¯æ ¸å¿ƒåŠŸèƒ½ âœ…

#### 1.1 Documentæ¨¡å‹æ‰©å±•
**æ–‡ä»¶:** `backend/app/models/document.py`

**ä¿®æ”¹å†…å®¹:**
- âœ… æ·»åŠ  `external_id` å­—æ®µï¼Œç”¨äºä¿å­˜T2Rankingæ•°æ®é›†çš„åŸå§‹doc_id
- ç”¨é€”ï¼šåœ¨æ–‡æ¡£å¯¼å…¥æ—¶ä¿ç•™å¤–éƒ¨æ•°æ®æºçš„IDï¼Œæ–¹ä¾¿åç»­è¿½æº¯å’Œæ˜ å°„

```python
external_id: Optional[str] = Field(None, description="å¤–éƒ¨æ•°æ®æºIDï¼ˆå¦‚T2Rankingçš„doc_idï¼‰")
```

#### 1.2 DocumentServiceæ‰¹é‡å¯¼å…¥åŠŸèƒ½
**æ–‡ä»¶:** `backend/app/services/document.py`

**æ–°å¢æ–¹æ³•:**
```python
async def batch_create_documents_from_dict(
    kb_id: str,
    documents: dict[str, str],  # {external_id: content}
    source: str = "import"
) -> Tuple[List[Document], List[dict]]
```

**åŠŸèƒ½è¯´æ˜:**
- âœ… æ‰¹é‡ä»å­—å…¸åˆ›å»ºæ–‡æ¡£
- âœ… è‡ªåŠ¨ç”Ÿæˆæ–‡æ¡£ID
- âœ… ä¿å­˜external_idæ˜ å°„
- âœ… è®°å½•æ–‡æ¡£å†…å®¹åˆ°contentå­—æ®µ
- âœ… ä½¿ç”¨è™šæ‹Ÿè·¯å¾„ï¼ˆæ— éœ€å®é™…æ–‡ä»¶ï¼‰
- âœ… è¿”å›æˆåŠŸå’Œå¤±è´¥è®°å½•

**ç‰¹ç‚¹:**
- çº¯æ–‡æœ¬å¯¼å…¥ï¼Œä¸éœ€è¦å®é™…æ–‡ä»¶ç³»ç»Ÿ
- æ–‡æ¡£çŠ¶æ€è®¾ä¸º `UPLOADED`
- ä¸ºæ¯ä¸ªæ–‡æ¡£æ·»åŠ metadataæ ‡è®°æ¥æº

#### 1.3 TestServiceæ‰¹é‡åˆ›å»ºæµ‹è¯•ç”¨ä¾‹
**æ–‡ä»¶:** `backend/app/services/test_service.py`

**æ–°å¢æ–¹æ³•:**
```python
async def batch_create_test_cases(
    test_set_id: str,
    test_cases_data: List[Dict[str, Any]]
) -> Tuple[List[TestCase], List[Dict]]
```

**åŠŸèƒ½è¯´æ˜:**
- âœ… æ‰¹é‡åˆ›å»ºæµ‹è¯•ç”¨ä¾‹
- âœ… è‡ªåŠ¨å…³è”æµ‹è¯•é›†
- âœ… è‡ªåŠ¨æ›´æ–°æµ‹è¯•é›†çš„ç”¨ä¾‹è®¡æ•°
- âœ… è¿”å›æˆåŠŸå’Œå¤±è´¥è®°å½•

**è¾“å…¥æ ¼å¼:**
```python
test_cases_data = [
    {
        "query": "æŸ¥è¯¢æ–‡æœ¬",
        "expected_chunks": ["doc_id1", "doc_id2"],
        "expected_answer": "æœŸæœ›ç­”æ¡ˆï¼ˆå¯é€‰ï¼‰",
        "metadata": {"query_id": "q001"}
    }
]
```

#### 1.4 å®Œå–„import_t2rankingæ¥å£
**æ–‡ä»¶:** `backend/app/controllers/retriever_evaluation.py`

**å®Œæ•´å®ç°æµç¨‹:**
1. âœ… åŠ è½½T2Rankingæ•°æ®é›†
2. âœ… éªŒè¯çŸ¥è¯†åº“å­˜åœ¨
3. âœ… æ‰¹é‡å¯¼å…¥æ–‡æ¡£ï¼ˆè°ƒç”¨batch_create_documents_from_dictï¼‰
4. âœ… åˆ›å»ºæµ‹è¯•é›†
5. âœ… æ„å»ºdoc_idæ˜ å°„ï¼ˆexternal_id â†’ document_idï¼‰
6. âœ… æ‰¹é‡åˆ›å»ºæµ‹è¯•ç”¨ä¾‹
7. âœ… è¿”å›è¯¦ç»†çš„å¯¼å…¥ç»“æœ

**è¿”å›æ•°æ®ç»“æ„:**
```json
{
  "statistics": {
    "total_documents": 100,
    "total_queries": 10,
    ...
  },
  "kb_id": "kb_xxx",
  "documents": {
    "total": 100,
    "created": 100,
    "failed": 0,
    "failed_records": []
  },
  "test_set": {
    "id": "ts_xxx",
    "name": "T2Rankingæµ‹è¯•é›†",
    "case_count": 10
  },
  "test_cases": {
    "total": 10,
    "created": 10,
    "failed": 0,
    "failed_records": []
  }
}
```

---

### 2. æµ‹è¯•è„šæœ¬ âœ…

**æ–‡ä»¶:** `backend/test_t2ranking_pipeline.py`

**åŠŸèƒ½:**
- âœ… å®Œæ•´æµ‹è¯•å¯¼å…¥é“¾è·¯
- âœ… æ­¥éª¤1ï¼šåŠ è½½æ•°æ®é›†å¹¶æ˜¾ç¤ºç»Ÿè®¡
- âœ… æ­¥éª¤2ï¼šåˆ›å»ºæµ‹è¯•çŸ¥è¯†åº“
- âœ… æ­¥éª¤3ï¼šæ‰¹é‡å¯¼å…¥æ–‡æ¡£
- âœ… æ­¥éª¤4ï¼šåˆ›å»ºæµ‹è¯•é›†
- âœ… æ­¥éª¤5ï¼šæ‰¹é‡åˆ›å»ºæµ‹è¯•ç”¨ä¾‹
- âœ… æ˜¾ç¤ºè¯¦ç»†çš„æ‰§è¡Œæ—¥å¿—
- âœ… å¼‚å¸¸å¤„ç†å’Œé”™è¯¯æç¤º

**ä½¿ç”¨æ–¹æ³•:**
```bash
cd backend
source .venv/bin/activate
python test_t2ranking_pipeline.py
```

**è¾“å‡ºç¤ºä¾‹:**
```
============================================================
T2Rankingæ•°æ®é›†å¯¼å…¥é“¾è·¯æµ‹è¯•
============================================================

ã€æ­¥éª¤1ã€‘åŠ è½½T2Rankingæ•°æ®é›†...
âœ… æ•°æ®é›†åŠ è½½æˆåŠŸ:
   - æ–‡æ¡£æ•°: 100
   - æŸ¥è¯¢æ•°: 10
   - æœ‰æ ‡æ³¨çš„æŸ¥è¯¢æ•°: 10
   - å¹³å‡ç›¸å…³æ–‡æ¡£æ•°: 3.5

ã€æ­¥éª¤2ã€‘åˆ›å»ºæµ‹è¯•çŸ¥è¯†åº“...
âœ… çŸ¥è¯†åº“åˆ›å»ºæˆåŠŸ:
   - ID: kb_abc123
   - åç§°: T2Rankingæµ‹è¯•çŸ¥è¯†åº“
   ...

ã€æ­¥éª¤3ã€‘æ‰¹é‡å¯¼å…¥æ–‡æ¡£åˆ°çŸ¥è¯†åº“...
âœ… æ–‡æ¡£å¯¼å…¥å®Œæˆ:
   - æˆåŠŸåˆ›å»º: 100 ä¸ª
   - å¤±è´¥: 0 ä¸ª
   ...

ã€æ­¥éª¤4ã€‘åˆ›å»ºæµ‹è¯•é›†...
âœ… æµ‹è¯•é›†åˆ›å»ºæˆåŠŸ:
   ...

ã€æ­¥éª¤5ã€‘æ‰¹é‡åˆ›å»ºæµ‹è¯•ç”¨ä¾‹...
âœ… æµ‹è¯•ç”¨ä¾‹åˆ›å»ºå®Œæˆ:
   - æˆåŠŸåˆ›å»º: 10 ä¸ª
   - å¤±è´¥: 0 ä¸ª

============================================================
âœ… é“¾è·¯æµ‹è¯•å®Œæˆï¼
============================================================
```

---

### 3. å‰ç«¯UIæ›´æ–° âœ…

**æ–‡ä»¶:** `web/components/views/retriever-evaluation.tsx`

**æ›´æ–°å†…å®¹:**

#### 3.1 çŠ¶æ€ç®¡ç†
```typescript
const [importResult, setImportResult] = useState<any>(null)
```

#### 3.2 å¯¼å…¥å¤„ç†å‡½æ•°
- âœ… è°ƒç”¨APIå¯¼å…¥æ•°æ®é›†
- âœ… ä¿å­˜å¯¼å…¥ç»“æœåˆ°çŠ¶æ€
- âœ… æ˜¾ç¤ºæˆåŠŸ/å¤±è´¥æç¤º

#### 3.3 å¯¼å…¥ç»“æœå±•ç¤º
**æ–°å¢UIç»„ä»¶:**
- âœ… çŸ¥è¯†åº“IDæ˜¾ç¤º
- âœ… æ–‡æ¡£å¯¼å…¥ç»Ÿè®¡ï¼ˆæ€»æ•°ã€æˆåŠŸã€å¤±è´¥ï¼‰
- âœ… æµ‹è¯•é›†ä¿¡æ¯ï¼ˆIDã€åç§°ã€ç”¨ä¾‹æ•°ï¼‰
- âœ… æµ‹è¯•ç”¨ä¾‹ç»Ÿè®¡ï¼ˆæ€»æ•°ã€æˆåŠŸã€å¤±è´¥ï¼‰
- âœ… ä¸‹ä¸€æ­¥æç¤º

**UIæ•ˆæœ:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âœ… å¯¼å…¥å®Œæˆ                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ çŸ¥è¯†åº“: kb_xxx                      â”‚
â”‚                                     â”‚
â”‚ æ–‡æ¡£å¯¼å…¥:                           â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚ â”‚ 100  â”‚  100 â”‚   0  â”‚            â”‚
â”‚ â”‚ æ€»æ•° â”‚ æˆåŠŸ â”‚ å¤±è´¥ â”‚            â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                                     â”‚
â”‚ æµ‹è¯•é›†:                             â”‚
â”‚ - åç§°: T2Rankingæµ‹è¯•é›†             â”‚
â”‚ - ID: ts_xxx                        â”‚
â”‚ - æµ‹è¯•ç”¨ä¾‹: 10ä¸ª                    â”‚
â”‚                                     â”‚
â”‚ æµ‹è¯•ç”¨ä¾‹å¯¼å…¥:                       â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚ â”‚  10  â”‚  10  â”‚   0  â”‚            â”‚
â”‚ â”‚ æ€»æ•° â”‚ æˆåŠŸ â”‚ å¤±è´¥ â”‚            â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                                     â”‚
â”‚ ğŸ’¡ ä¸‹ä¸€æ­¥ï¼šæ–‡æ¡£å‘é‡åŒ–ï¼ˆå¼€å‘ä¸­ï¼‰     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### 4. é“¾è·¯æ’æŸ¥æ–‡æ¡£ âœ…

**æ–‡ä»¶:** `backend/é“¾è·¯æ’æŸ¥_T2Rankingå¯¼å…¥.md`

**å†…å®¹åŒ…æ‹¬:**
- âœ… å®Œæ•´é“¾è·¯å›¾ï¼ˆ7ä¸ªæ­¥éª¤ï¼‰
- âœ… æ¯ä¸ªèŠ‚ç‚¹çš„è¯¦ç»†åˆ†æ
- âœ… å®ç°çŠ¶æ€æ ‡è¯†ï¼ˆâœ…/âŒï¼‰
- âœ… è¾“å…¥è¾“å‡ºæ ¼å¼è¯´æ˜
- âœ… ç¼ºå¤±åŠŸèƒ½æ±‡æ€»
- âœ… å®æ–½è®¡åˆ’ï¼ˆåˆ†3ä¸ªé˜¶æ®µï¼‰
- âœ… é¢„è®¡å·¥ä½œé‡è¯„ä¼°

---

## æ•°æ®æµè¯´æ˜

### å®Œæ•´æ•°æ®æµè½¬

```
T2Ranking TSVæ–‡ä»¶
    â†“
dataset.load_collection()
    â†“ {doc_id: content}
    â†“
DocumentService.batch_create_documents_from_dict()
    â†“ [Documentå¯¹è±¡åˆ—è¡¨]
    â†“ æ¯ä¸ªDocumentåŒ…å«:
    â†“   - id: æ–°ç”Ÿæˆçš„document_id
    â†“   - external_id: åŸå§‹doc_id
    â†“   - content: æ–‡æ¡£å†…å®¹
    â†“
åˆ›å»ºæ˜ å°„: {external_id â†’ document_id}
    â†“
dataset.get_test_cases()
    â†“ [{query, relevant_doc_ids}]
    â†“
è½¬æ¢doc_ids: relevant_doc_ids â†’ expected_chunks
    â†“ ä½¿ç”¨æ˜ å°„: external_id â†’ document_id
    â†“
TestService.batch_create_test_cases()
    â†“ [TestCaseå¯¹è±¡åˆ—è¡¨]
    â†“ æ¯ä¸ªTestCaseåŒ…å«:
    â†“   - query: æŸ¥è¯¢æ–‡æœ¬
    â†“   - expected_chunks: [document_idåˆ—è¡¨]
    â†“   - metadata: {query_id, original_doc_ids}
    â†“
å®Œæˆå¯¼å…¥
```

### å…³é”®æ˜ å°„å…³ç³»

**T2Ranking â†’ ç³»ç»Ÿå†…éƒ¨:**
- `T2Ranking doc_id` â†’ `Document.external_id` â†’ `Document.id`
- `T2Ranking query_id` â†’ `TestCase.metadata.query_id`
- `qrels[query_id] = [doc_ids]` â†’ `TestCase.expected_chunks = [document_ids]`

---

## æµ‹è¯•éªŒè¯

### APIæµ‹è¯•

#### 1. è·å–æ•°æ®é›†ç»Ÿè®¡
```bash
curl "http://localhost:8000/api/v1/retriever-evaluation/dataset-statistics?collection_path=/path/to/collection.tsv&queries_path=/path/to/queries.dev.tsv&qrels_path=/path/to/qrels.dev.tsv&max_queries=10"
```

**é¢„æœŸè¾“å‡º:**
```json
{
  "success": true,
  "data": {
    "total_documents": 100,
    "total_queries": 10,
    "queries_with_relevant_docs": 10,
    "avg_relevant_docs_per_query": 3.5,
    ...
  }
}
```

#### 2. å¯¼å…¥æ•°æ®é›†
```bash
curl -X POST "http://localhost:8000/api/v1/retriever-evaluation/import-t2ranking" \
  -H "Content-Type: application/json" \
  -d '{
    "kb_id": "kb_demo",
    "test_set_name": "T2Rankingæµ‹è¯•é›†",
    "collection_path": "/path/to/collection.tsv",
    "queries_path": "/path/to/queries.dev.tsv",
    "qrels_path": "/path/to/qrels.dev.tsv",
    "max_queries": 10
  }'
```

**é¢„æœŸè¾“å‡º:**
```json
{
  "success": true,
  "data": {
    "documents": {"created": 100, "failed": 0},
    "test_cases": {"created": 10, "failed": 0},
    ...
  },
  "message": "T2Rankingæ•°æ®é›†å¯¼å…¥æˆåŠŸ: 100ä¸ªæ–‡æ¡£, 10ä¸ªæµ‹è¯•ç”¨ä¾‹"
}
```

---

## å½“å‰é™åˆ¶

### å·²å®ç° âœ…
- [x] æ•°æ®é›†åŠ è½½ï¼ˆcollection, queries, qrelsï¼‰
- [x] æ‰¹é‡æ–‡æ¡£åˆ›å»º
- [x] æ‰¹é‡æµ‹è¯•ç”¨ä¾‹åˆ›å»º
- [x] external_idæ˜ å°„
- [x] å®Œæ•´çš„é”™è¯¯å¤„ç†
- [x] å‰ç«¯å¯¼å…¥ç»“æœå±•ç¤º

### å¾…å®ç° âŒ
- [ ] æ–‡æ¡£å‘é‡åŒ–ï¼ˆåˆ†å—ã€embeddingã€ç´¢å¼•ï¼‰
- [ ] æ£€ç´¢åŠŸèƒ½ï¼ˆåŸºäºå‘é‡DBï¼‰
- [ ] è¯„ä¼°æ‰§è¡Œï¼ˆè°ƒç”¨æ£€ç´¢ã€è®¡ç®—æŒ‡æ ‡ï¼‰
- [ ] JSONå¯¼å…¥å¯¼å‡ºï¼ˆä¸­é—´æ­¥éª¤æ•°æ®æŒä¹…åŒ–ï¼‰
- [ ] è¯„ä¼°ç»“æœä¿å­˜å’Œå±•ç¤º

---

## ä¸‹ä¸€æ­¥è®¡åˆ’

### é˜¶æ®µ2ï¼šå‘é‡åŒ–é“¾è·¯ï¼ˆä¼˜å…ˆçº§ï¼šé«˜ï¼‰

#### 2.1 æ–‡æ¡£å¤„ç†æµæ°´çº¿
**æ–‡ä»¶:** æ–°å»º `backend/app/services/document_processor.py`

**éœ€è¦å®ç°:**
1. æ–‡æ¡£åˆ†å—ï¼ˆæ ¹æ®çŸ¥è¯†åº“é…ç½®çš„chunk_sizeï¼‰
2. æ‰¹é‡å‘é‡åŒ–ï¼ˆè°ƒç”¨embeddingæœåŠ¡ï¼‰
3. æ‰¹é‡å†™å…¥å‘é‡æ•°æ®åº“
4. æ›´æ–°æ–‡æ¡£å’ŒchunkçŠ¶æ€

#### 2.2 RAGæ£€ç´¢åŠŸèƒ½
**æ–‡ä»¶:** `backend/app/services/rag_service.py`

**éœ€è¦å®ç°:**
1. æŸ¥è¯¢å‘é‡åŒ–
2. å‘é‡æ£€ç´¢ï¼ˆä»å‘é‡DBï¼‰
3. è¿”å›ç›¸å…³æ–‡æ¡£IDåˆ—è¡¨

#### 2.3 è¯„ä¼°æ‰§è¡Œ
**æ–‡ä»¶:** `backend/app/controllers/retriever_evaluation.py`

**éœ€è¦å®ç°:**
1. è°ƒç”¨RAGæ£€ç´¢
2. è®¡ç®—è¯„ä¼°æŒ‡æ ‡ï¼ˆä½¿ç”¨RetrieverEvaluatorï¼‰
3. ä¿å­˜è¯„ä¼°ç»“æœ
4. è¿”å›è¯„ä¼°æŠ¥å‘Š

---

### é˜¶æ®µ3ï¼šJSONå¯¼å…¥å¯¼å‡ºï¼ˆä¼˜å…ˆçº§ï¼šä¸­ï¼‰

ä¸ºæ¯ä¸ªæ­¥éª¤æ·»åŠ JSONå¯¼å‡ºåŠŸèƒ½ï¼Œæ–¹ä¾¿è°ƒè¯•å’Œæ‰‹åŠ¨å¹²é¢„ï¼š

1. **å¯¼å‡ºæ•°æ®é›†JSON**
   - API: `POST /retriever-evaluation/export-dataset`
   - è¾“å‡º: `t2ranking_export_{timestamp}.json`

2. **å¯¼å‡ºæ–‡æ¡£JSON**
   - API: `GET /documents/export?kb_id=xxx`
   - è¾“å‡º: `documents_{kb_id}_{timestamp}.json`

3. **å¯¼å‡ºæµ‹è¯•ç”¨ä¾‹JSON**
   - API: `GET /tests/test-cases/export?test_set_id=xxx`
   - è¾“å‡º: `test_cases_{test_set_id}_{timestamp}.json`

4. **JSONå¯¼å…¥æ¥å£**
   - `POST /documents/import-json`
   - `POST /tests/test-cases/import-json`

---

## ç›¸å…³æ–‡ä»¶æ¸…å•

### åç«¯

#### ä¿®æ”¹çš„æ–‡ä»¶
- `backend/app/models/document.py` - æ·»åŠ external_idå­—æ®µ
- `backend/app/services/document.py` - æ‰¹é‡åˆ›å»ºæ–‡æ¡£
- `backend/app/services/test_service.py` - æ‰¹é‡åˆ›å»ºæµ‹è¯•ç”¨ä¾‹
- `backend/app/controllers/retriever_evaluation.py` - å®Œå–„importæ¥å£

#### æ–°å»ºçš„æ–‡ä»¶
- `backend/test_t2ranking_pipeline.py` - é“¾è·¯æµ‹è¯•è„šæœ¬
- `backend/é“¾è·¯æ’æŸ¥_T2Rankingå¯¼å…¥.md` - å®Œæ•´é“¾è·¯åˆ†ææ–‡æ¡£
- `backend/é“¾è·¯å®æ–½æ€»ç»“.md` - æœ¬æ–‡æ¡£

### å‰ç«¯

#### ä¿®æ”¹çš„æ–‡ä»¶
- `web/components/views/retriever-evaluation.tsx` - æ·»åŠ å¯¼å…¥ç»“æœå±•ç¤º

---

## ä½¿ç”¨æŒ‡å—

### 1. å¿«é€Ÿæµ‹è¯•ï¼ˆä½¿ç”¨æµ‹è¯•è„šæœ¬ï¼‰

```bash
cd backend
source .venv/bin/activate
python test_t2ranking_pipeline.py
```

### 2. é€šè¿‡APIæµ‹è¯•

**æ­¥éª¤1ï¼š** æ£€æŸ¥æ•°æ®é›†
```bash
curl "http://localhost:8000/api/v1/retriever-evaluation/dataset-statistics?..."
```

**æ­¥éª¤2ï¼š** åˆ›å»ºçŸ¥è¯†åº“ï¼ˆä½¿ç”¨å‰ç«¯æˆ–APIï¼‰

**æ­¥éª¤3ï¼š** å¯¼å…¥æ•°æ®é›†
```bash
curl -X POST "http://localhost:8000/api/v1/retriever-evaluation/import-t2ranking" ...
```

### 3. é€šè¿‡å‰ç«¯æµ‹è¯•

1. å¯åŠ¨å‰ç«¯: `cd web && npm run dev`
2. è®¿é—®"æ£€ç´¢å™¨è¯„ä¼°"é¡µé¢
3. ç‚¹å‡»"è·å–æ•°æ®é›†ç»Ÿè®¡"æŸ¥çœ‹æ•°æ®é›†ä¿¡æ¯
4. ç‚¹å‡»"å¯¼å…¥æ•°æ®é›†åˆ°çŸ¥è¯†åº“"å¼€å§‹å¯¼å…¥
5. æŸ¥çœ‹å¯¼å…¥ç»“æœç»Ÿè®¡

---

## å¸¸è§é—®é¢˜

### Q1: å¯¼å…¥æ—¶æç¤º"çŸ¥è¯†åº“ä¸å­˜åœ¨"
**A:** éœ€è¦å…ˆåˆ›å»ºçŸ¥è¯†åº“ï¼Œä¿®æ”¹å‰ç«¯ä»£ç ä¸­çš„ `kb_id: "kb_demo"` ä¸ºå®é™…çš„çŸ¥è¯†åº“IDã€‚

### Q2: æ•°æ®é›†æ–‡ä»¶æœªæ‰¾åˆ°
**A:** æ£€æŸ¥å‰ç«¯å’Œæµ‹è¯•è„šæœ¬ä¸­çš„æ–‡ä»¶è·¯å¾„é…ç½®ï¼Œç¡®ä¿è·¯å¾„æ­£ç¡®ã€‚

### Q3: æ–‡æ¡£åˆ›å»ºæˆåŠŸä½†å†…å®¹ä¸ºç©º
**A:** æ£€æŸ¥TSVæ–‡ä»¶æ ¼å¼ï¼Œç¡®ä¿æ˜¯ `\t` åˆ†éš”çš„ä¸¤åˆ—ï¼šdoc_id å’Œ contentã€‚

### Q4: æµ‹è¯•ç”¨ä¾‹çš„expected_chunksä¸ºç©º
**A:** å¯èƒ½æ˜¯doc_idæ˜ å°„å¤±è´¥ï¼Œæ£€æŸ¥ï¼š
- collection.tsvä¸­çš„doc_id
- qrels.tsvä¸­çš„doc_id
- ä¸¤è€…æ˜¯å¦åŒ¹é…

---

## æ€§èƒ½å»ºè®®

### å¼€å‘æµ‹è¯•
- ä½¿ç”¨ `max_docs=100, max_queries=10` å¿«é€Ÿæµ‹è¯•
- å®Œæ•´æ•°æ®é›†å¯èƒ½éœ€è¦å‡ åˆ†é’Ÿ

### ç”Ÿäº§ç¯å¢ƒ
- å»ºè®®åˆ†æ‰¹å¯¼å…¥ï¼ˆæ¯æ¬¡1000ä¸ªæ–‡æ¡£ï¼‰
- ä½¿ç”¨å¼‚æ­¥ä»»åŠ¡å¤„ç†å¤§æ‰¹é‡å¯¼å…¥
- æ·»åŠ è¿›åº¦è¿½è¸ªæœºåˆ¶

---

## æ€»ç»“

### æœ¬æ¬¡å®æ–½å®Œæˆåº¦

| æ¨¡å— | å®Œæˆåº¦ | è¯´æ˜ |
|------|--------|------|
| æ•°æ®åŠ è½½ | 100% | âœ… å®Œå…¨å®ç° |
| æ–‡æ¡£å¯¼å…¥ | 100% | âœ… æ‰¹é‡åˆ›å»ºå®Œæˆ |
| æµ‹è¯•ç”¨ä¾‹å¯¼å…¥ | 100% | âœ… æ‰¹é‡åˆ›å»ºå®Œæˆ |
| æ–‡æ¡£å‘é‡åŒ– | 0% | âŒ å¾…å®ç° |
| æ£€ç´¢åŠŸèƒ½ | 0% | âŒ å¾…å®ç° |
| è¯„ä¼°æ‰§è¡Œ | 0% | âŒ å¾…å®ç° |
| JSONå¯¼å‡º | 0% | âŒ å¾…å®ç° |

### æ ¸å¿ƒä»·å€¼
âœ… **æ‰“é€šäº†ä»T2Rankingæ•°æ®é›†åˆ°ç³»ç»Ÿå†…éƒ¨å­˜å‚¨çš„å®Œæ•´æ•°æ®æµ**
- æ–‡æ¡£å¯ä»¥å®Œæ•´å¯¼å…¥å¹¶ä¿å­˜
- æµ‹è¯•ç”¨ä¾‹å¯ä»¥æ­£ç¡®åˆ›å»ºå¹¶å…³è”
- doc_idæ˜ å°„å…³ç³»æ¸…æ™°
- å‰åç«¯é“¾è·¯å·²æ‰“é€š

### åç»­é‡ç‚¹
ä¸‹ä¸€æ­¥é‡ç‚¹æ˜¯**æ–‡æ¡£å‘é‡åŒ–**ï¼Œè¿™æ˜¯æ‰§è¡Œæ£€ç´¢è¯„ä¼°çš„å‰ææ¡ä»¶ã€‚

---

**å®æ–½æ—¥æœŸ:** 2025-11-07  
**æ–‡æ¡£ç‰ˆæœ¬:** v1.0  
**å®æ–½äººå‘˜:** AI Assistant

